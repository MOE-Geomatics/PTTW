# ---------------------------------------------------------------------------
# PTTW_Step1.py
# Created on: Thu Jul 11 2013 02:30:44 PM
#   (generated by ArcGIS/ModelBuilder)
# ---------------------------------------------------------------------------
# PTTW data processing python script. 
# The input of this script is a file geodtabase containing one feature class named PTTW under Water feature Dataset
# and one table named PTTW_no_UTM. The former contains the water taking location with valid coordinates and the 
# later contains the water taking locatiion without valid coordinates. The projection for the feature class is 
# Lambert_Conformal_Conic. 

# Step 1. Merge the feature class and the table together into one feature class and convert the projection to NAD83. 

# Import system modules
import sys, string, os, arcgisscripting

# Create the Geoprocessor object
gp = arcgisscripting.create()

# Load required toolboxes...
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Conversion Tools.tbx")
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Data Management Tools.tbx")
gp.AddToolbox("C:/Program Files/ArcGIS/ArcToolbox/Toolboxes/Analysis Tools.tbx")

# Local variables...
PATH = "C:\\working\\PTTW\\20130705"
GDB_PATH = PATH + "\\PTTW.gdb"
PTTW = GDB_PATH + "\\Water\\PTTW"  #Input feature class
PTTW_no_UTM = GDB_PATH + "\\PTTW_no_UTM"  #Input no UTM table

PTTW_NAD83 = GDB_PATH + "\\PTTW_NAD83"  #Output feature class
PTTW_no_UTM_Layer = "PTTW_no_UTM_Layer"
PTTW_NO_UTM_Layer = GDB_PATH + "\\PTTW_NO_UTM_Layer" #for store the feature class for the records without valid coordinate. 

PTTW_DataDownload = GDB_PATH + "\\PTTW_DataDownload"
PTTW_DataDownload_Active = GDB_PATH + "\\PTTW_DataDownload_Active"
PTTW_Active_WebMercater = GDB_PATH + "\\PTTW_Active_WebMercater"
WSHED_TERT_20110530_Simplify = "Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify"
PermitsToTakeWater_Active_Watershed = GDB_PATH + "\\PermitsToTakeWater_Active_Watershed"


if gp.Exists(PTTW_NAD83):
	gp.Delete_management(PTTW_NAD83, "FeatureClass")
if gp.Exists(PTTW_NO_UTM_Layer):
	gp.Delete_management(PTTW_NO_UTM_Layer, "FeatureClass")
if gp.Exists(PTTW_DataDownload):
	gp.Delete_management(PTTW_DataDownload, "FeatureClass")
if gp.Exists(PTTW_DataDownload_Active):
	gp.Delete_management(PTTW_DataDownload_Active, "FeatureClass")
if gp.Exists(PTTW_Active_WebMercater):
	gp.Delete_management(PTTW_Active_WebMercater, "FeatureClass")
if gp.Exists(PermitsToTakeWater_Active_Watershed):
	gp.Delete_management(PermitsToTakeWater_Active_Watershed, "FeatureClass")
	
# Process: Add Field (3)...
latitudeFields = gp.ListFields(PTTW_no_UTM, "LATITUDE")
latitude_field_found = latitudeFields.Next()
#print latitude_field_found
if not latitude_field_found:
	gp.AddField_management(PTTW_no_UTM, "LATITUDE", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (4)...
longitudeFields = gp.ListFields(PTTW_no_UTM, "LONGITUDE")
longitude_field_found = longitudeFields.Next()
if not longitude_field_found:
	gp.AddField_management(PTTW_no_UTM, "LONGITUDE", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field...
gp.CalculateField_management(PTTW_no_UTM, "LATITUDE", "0", "VB", "")

# Process: Calculate Field (2)...
gp.CalculateField_management(PTTW_no_UTM, "LONGITUDE", "0", "VB", "")

# Process: Make XY Event Layer...
gp.MakeXYEventLayer_management(PTTW_no_UTM, "longitude", "latitude", PTTW_no_UTM_Layer, "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]];-400 -400 1000000000;0 1;0 1;8.98315284119521E-09;0.001;0.001;IsHighPrecision")

# Process: Feature Class to Feature Class...
gp.FeatureClassToFeatureClass_conversion(PTTW_no_UTM_Layer, GDB_PATH, "PTTW_NO_UTM_Layer", "", "PERMITNO 'PERMITNO' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",PERMITNO,-1,-1;FILENO 'FILENO' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",FILENO,-1,-1;CLIENTNAME 'CLIENTNAME' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",CLIENTNAME,-1,-1;CLIENTNO 'CLIENTNO' true true false 150 Text 0 0 ,First,#," +  PTTW_no_UTM + ",CLIENTNO,-1,-1;PURPOSECAT 'PURPOSECAT' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",PURPOSECAT,-1,-1;SPURPOSE 'SPURPOSE' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",SPURPOSE,-1,-1;EXPIRYDATE 'EXPIRYDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_no_UTM + ",EXPIRYDATE,-1,-1;ISSUEDDATE 'ISSUEDDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_no_UTM + ",ISSUEDDATE,-1,-1;RENEWDATE 'RENEWDATE' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",RENEWDATE,-1,-1;OLDCTYTWN 'OLDCTYTWN' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",OLDCTYTWN,-1,-1;P_LOT 'P_LOT' true true false 150 Text 0 0 ,First,#," +  PTTW_no_UTM + ",P_LOT,-1,-1;P_CON 'P_CON' true true false 150 Text 0 0 ,First,#," +  PTTW_no_UTM + ",P_CON,-1,-1;P_MUNICIP 'P_MUNICIP' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",P_MUNICIP,-1,-1;P_UPPERT 'P_UPPERT' true true false 150 Text 0 0 ,First,#," +  PTTW_no_UTM + ",P_UPPERT,-1,-1;P_LOWERT 'P_LOWERT' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",P_LOWERT,-1,-1;ADDRESS 'ADDRESS' true true false 200 Text 0 0 ,First,#," +  PTTW_no_UTM + ",ADDRESS,-1,-1;CITY 'CITY' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",CITY,-1,-1;PROVINCE 'PROVINCE' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",PROVINCE,-1,-1;POSTALCODE 'POSTALCODE' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",POSTALCODE,-1,-1;PHONE 'PHONE' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",PHONE,-1,-1;SURFGRND 'SURFGRND' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",SURFGRND,-1,-1;SOURCEID 'SOURCEID' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",SOURCEID,-1,-1;EASTING 'EASTING' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",EASTING,-1,-1;NORTHING 'NORTHING' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",NORTHING,-1,-1;UTMZONE 'UTMZONE' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",UTMZONE,-1,-1;MAXL_DAY 'MAXL_DAY' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",MAXL_DAY,-1,-1;DAYS_YEAR 'DAYS_YEAR' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",DAYS_YEAR,-1,-1;HRS_DAYMAX 'HRS_DAYMAX' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",HRS_DAYMAX,-1,-1;L_MINUTE 'L_MINUTE' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",L_MINUTE,-1,-1;AMENDED_BY 'AMENDED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",AMENDED_BY,-1,-1;EXPIRED_BY 'EXPIRED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",EXPIRED_BY,-1,-1;PERMIT_END 'PERMIT_END' true true false 8 Date 0 0 ,First,#," +  PTTW_no_UTM + ",PERMIT_END,-1,-1;OUTOFUTM 'OUTOFUTM' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",OUTOFUTM,-1,-1;ORIGEAST 'ORIGEAST' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",ORIGEAST,-1,-1;ORIGNORTH 'ORIGNORTH' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",ORIGNORTH,-1,-1;NOUTM 'NOUTM' true true false 8 Double 0 0 ,First,#," +  PTTW_no_UTM + ",NOUTM,-1,-1;ACTIVE 'ACTIVE' true true false 3 Text 0 0 ,First,#," +  PTTW_no_UTM + ",ACTIVE,-1,-1;ID 'ID' true true false 100 Text 0 0 ,First,#," +  PTTW_no_UTM + ",ID,-1,-1;MUN_CA_AUT 'MUN_CA_AUT' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",MUN_CA_AUT,-1,-1;REFERENCE 'REFERENCE' true true false 50 Text 0 0 ,First,#," +  PTTW_no_UTM + ",REFERENCE,-1,-1;UNIQUE 'UNIQUE' true true false 254 Text 0 0 ,First,#," +  PTTW_no_UTM + ",UNIQUE,-1,-1;fix 'fix' true true false 2 Short 0 0 ,First,#," +  PTTW_no_UTM + ",fix,-1,-1;LATITUDE 'LATITUDE' true true false -1 Double -1 -2 ,First,#," +  PTTW_no_UTM + ",LATITUDE,-1,-1;LONGITUDE 'LONGITUDE' true true false -1 Double -1 -2 ,First,#," +  PTTW_no_UTM + ",LONGITUDE,-1,-1", "")

# Process: Project...
gp.Project_management(PTTW, PTTW_NAD83, "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]", "", "PROJCS['MNR_Lambert_Conformal_Conic',GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Lambert_Conformal_Conic'],PARAMETER['False_Easting',930000.0],PARAMETER['False_Northing',6430000.0],PARAMETER['Central_Meridian',-85.0],PARAMETER['Standard_Parallel_1',44.5],PARAMETER['Standard_Parallel_2',53.5],PARAMETER['Latitude_Of_Origin',0.0],UNIT['Meter',1.0]]")

# Process: Add Field...
gp.AddField_management(PTTW_NAD83, "LATITUDE", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Add Field (2)...
gp.AddField_management(PTTW_NAD83, "LONGITUDE", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field (3)...
#gp.CalculateField_management(PTTW_NAD83__3_, "LATITUDE", "pPoint.Y", "VB", "Dim pGeo As IGeometry\nSet pGeo = [Shape]\nDim pPoint As IPoint\nSet pPoint = pGeo")
yExpression = "float(!SHAPE.CENTROID!.split()[1])"
gp.CalculateField_management(PTTW_NAD83, "LATITUDE", yExpression, "PYTHON")

# Process: Calculate Field (4)...
#gp.CalculateField_management(PTTW_NAD83__4_, "LONGITUDE", "pPoint.X", "VB", "Dim pGeo As IGeometry\nSet pGeo = [Shape]\nDim pPoint As IPoint\nSet pPoint = pGeo")
xExpression = "float(!SHAPE.CENTROID!.split()[0])"
gp.CalculateField_management(PTTW_NAD83, "LONGITUDE", xExpression, "PYTHON")

# Process: Append...
gp.Append_management(PTTW_NO_UTM_Layer, PTTW_NAD83, "NO_TEST", "PERMITNO 'PERMITNO' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",PERMITNO,-1,-1;FILENO 'FILENO' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",FILENO,-1,-1;CLIENTNAME 'CLIENTNAME' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",CLIENTNAME,-1,-1;CLIENTNO 'CLIENTNO' true true false 150 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",CLIENTNO,-1,-1;PURPOSECAT 'PURPOSECAT' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",PURPOSECAT,-1,-1;SPURPOSE 'SPURPOSE' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",SPURPOSE,-1,-1;EXPIRYDATE 'EXPIRYDATE' true true false 8 Date 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",EXPIRYDATE,-1,-1;ISSUEDDATE 'ISSUEDDATE' true true false 8 Date 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",ISSUEDDATE,-1,-1;RENEWDATE 'RENEWDATE' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",RENEWDATE,-1,-1;OLDCTYTWN 'OLDCTYTWN' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",OLDCTYTWN,-1,-1;P_LOT 'P_LOT' true true false 150 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",P_LOT,-1,-1;P_CON 'P_CON' true true false 150 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",P_CON,-1,-1;P_MUNICIP 'P_MUNICIP' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",P_MUNICIP,-1,-1;P_UPPERT 'P_UPPERT' true true false 150 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",P_UPPERT,-1,-1;P_LOWERT 'P_LOWERT' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",P_LOWERT,-1,-1;ADDRESS 'ADDRESS' true true false 200 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",ADDRESS,-1,-1;CITY 'CITY' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",CITY,-1,-1;PROVINCE 'PROVINCE' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",PROVINCE,-1,-1;POSTALCODE 'POSTALCODE' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",POSTALCODE,-1,-1;PHONE 'PHONE' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",PHONE,-1,-1;SURFGRND 'SURFGRND' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",SURFGRND,-1,-1;SOURCEID 'SOURCEID' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",SOURCEID,-1,-1;EASTING 'EASTING' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",EASTING,-1,-1;NORTHING 'NORTHING' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",NORTHING,-1,-1;UTMZONE 'UTMZONE' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",UTMZONE,-1,-1;MAXL_DAY 'MAXL_DAY' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",MAXL_DAY,-1,-1;DAYS_YEAR 'DAYS_YEAR' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",DAYS_YEAR,-1,-1;HRS_DAYMAX 'HRS_DAYMAX' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",HRS_DAYMAX,-1,-1;L_MINUTE 'L_MINUTE' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",L_MINUTE,-1,-1;AMENDED_BY 'AMENDED_BY' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",AMENDED_BY,-1,-1;EXPIRED_BY 'EXPIRED_BY' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",EXPIRED_BY,-1,-1;PERMIT_END 'PERMIT_END' true true false 8 Date 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",PERMIT_END,-1,-1;ORIGEAST 'ORIGEAST' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",ORIGEAST,-1,-1;ORIGNORTH 'ORIGNORTH' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",ORIGNORTH,-1,-1;ACTIVE 'ACTIVE' true true false 3 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",ACTIVE,-1,-1;MUN_CA_AUT 'MUN_CA_AUT' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",MUN_CA_AUT,-1,-1;REFERENCE 'REFERENCE' true true false 50 Text 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",REFERENCE,-1,-1;LATITUDE 'LATITUDE' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",LATITUDE,-1,-1;LONGITUDE 'LONGITUDE' true true false 8 Double 0 0 ,First,#," + PTTW_NO_UTM_Layer + ",LONGITUDE,-1,-1", "")
gp.Delete_management(PTTW_NO_UTM_Layer, "FeatureClass")
# Process: Add Field...
gp.AddField_management(PTTW_NAD83, "OUTOFUTM", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (2)...
gp.AddField_management(PTTW_NAD83, "NOUTM", "DOUBLE", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (3)...
gp.AddField_management(PTTW_NAD83, "PERMIT_UC", "TEXT", "", "", "50", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (4)...
gp.AddField_management(PTTW_NAD83, "FILENO_UC", "TEXT", "", "", "200", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (5)...
gp.AddField_management(PTTW_NAD83, "CLNTNM_UC", "TEXT", "", "", "200", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (6)...
gp.AddField_management(PTTW_NAD83, "CLNTNO_UC", "TEXT", "", "", "150", "", "NULLABLE", "NON_REQUIRED", "")
  
# Process: Add Field (9)...
gp.AddField_management(PTTW_NAD83, "ID", "TEXT", "", "", "500", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Add Field (10)...
gp.AddField_management(PTTW_NAD83, "LEGEND", "TEXT", "", "", "50", "", "NULLABLE", "NON_REQUIRED", "")
 
# Process: Calculate Field...
gp.CalculateField_management(PTTW_NAD83, "PERMIT_UC", "UCase ( [PERMITNO] )", "VB", "")
 
# Process: Calculate Field (2)...
gp.CalculateField_management(PTTW_NAD83, "FILENO_UC", "UCase ( [FILENO]  )", "VB", "")
 
# Process: Calculate Field (3)...
gp.CalculateField_management(PTTW_NAD83, "CLNTNM_UC", "UCase ( [CLIENTNAME] )", "VB", "")
 
# Process: Calculate Field (4)...
gp.CalculateField_management(PTTW_NAD83, "CLNTNO_UC", "UCase ( [CLIENTNO] )", "VB", "")
  
# Process: Calculate Field (7)...
#gp.CalculateField_management(PTTW_NAD83, "ID", "[PERMITNO] & \"--\" & Str( [UTMZONE] )& \"--\" & [SOURCEID]", "VB", "")
#idExpression = '!PERMITNO! + str(!UTMZONE!) + !SOURCEID!'
#gp.CalculateField_management(PTTW_NAD83, "ID", idExpression, "PYTHON")
  
# Process: Calculate Field (8)...
expression = "getLegendValue(!ACTIVE!, !SURFGRND!)"
codeblock = "def getLegendValue(active, surfgrnd):\n    if active == 'No':\n        return 'No'\n    else:\n        return 'Yes-' + surfgrnd"
gp.CalculateField_management(PTTW_NAD83, "LEGEND", expression, "PYTHON", codeblock)
#gp.CalculateField_management(PTTW_NAD83, "LEGEND", "result", "VB", "dim result as String\\n\\nif [ACTIVE] = 'No' then\\n    result   =  'No'\\nend if\\n\\nif [ACTIVE] = 'Yes' then\\n    result   =  'Yes' & \"-\" & [SURFGRND]\\nend if")

# Process: Feature Class to Feature Class...
gp.FeatureClassToFeatureClass_conversion(PTTW_NAD83, GDB_PATH, "PTTW_DataDownload", "", "PERMITNO 'PERMITNO' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",PERMITNO,-1,-1;FILENO 'FILENO' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",FILENO,-1,-1;CLIENTNAME 'CLIENTNAME' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",CLIENTNAME,-1,-1;CLIENTNO 'CLIENTNO' true true false 150 Text 0 0 ,First,#," +  PTTW_NAD83 + ",CLIENTNO,-1,-1;PURPOSECAT 'PURPOSECAT' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",PURPOSECAT,-1,-1;SPURPOSE 'SPURPOSE' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",SPURPOSE,-1,-1;EXPIRYDATE 'EXPIRYDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_NAD83 + ",EXPIRYDATE,-1,-1;ISSUEDDATE 'ISSUEDDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_NAD83 + ",ISSUEDDATE,-1,-1;RENEWDATE 'RENEWDATE' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",RENEWDATE,-1,-1;OLDCTYTWN 'OLDCTYTWN' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",OLDCTYTWN,-1,-1;P_LOT 'P_LOT' true true false 150 Text 0 0 ,First,#," +  PTTW_NAD83 + ",P_LOT,-1,-1;P_CON 'P_CON' true true false 150 Text 0 0 ,First,#," +  PTTW_NAD83 + ",P_CON,-1,-1;P_MUNICIP 'P_MUNICIP' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",P_MUNICIP,-1,-1;P_UPPERT 'P_UPPERT' true true false 150 Text 0 0 ,First,#," +  PTTW_NAD83 + ",P_UPPERT,-1,-1;P_LOWERT 'P_LOWERT' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",P_LOWERT,-1,-1;ADDRESS 'ADDRESS' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",ADDRESS,-1,-1;CITY 'CITY' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",CITY,-1,-1;PROVINCE 'PROVINCE' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",PROVINCE,-1,-1;POSTALCODE 'POSTALCODE' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",POSTALCODE,-1,-1;PHONE 'PHONE' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",PHONE,-1,-1;SURFGRND 'SURFGRND' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",SURFGRND,-1,-1;SOURCEID 'SOURCEID' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",SOURCEID,-1,-1;EASTING 'EASTING' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",EASTING,-1,-1;NORTHING 'NORTHING' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",NORTHING,-1,-1;UTMZONE 'UTMZONE' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",UTMZONE,-1,-1;MAXL_DAY 'MAXL_DAY' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",MAXL_DAY,-1,-1;DAYS_YEAR 'DAYS_YEAR' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",DAYS_YEAR,-1,-1;HRS_DAYMAX 'HRS_DAYMAX' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",HRS_DAYMAX,-1,-1;L_MINUTE 'L_MINUTE' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",L_MINUTE,-1,-1;AMENDED_BY 'AMENDED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",AMENDED_BY,-1,-1;EXPIRED_BY 'EXPIRED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",EXPIRED_BY,-1,-1;PERMIT_END 'PERMIT_END' true true false 8 Date 0 0 ,First,#," +  PTTW_NAD83 + ",PERMIT_END,-1,-1;ORIGEAST 'ORIGEAST' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",ORIGEAST,-1,-1;ORIGNORTH 'ORIGNORTH' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",ORIGNORTH,-1,-1;ACTIVE 'ACTIVE' true true false 3 Text 0 0 ,First,#," +  PTTW_NAD83 + ",ACTIVE,-1,-1;MUN_CA_AUT 'MUN_CA_AUT' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",MUN_CA_AUT,-1,-1;REFERENCE 'REFERENCE' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",REFERENCE,-1,-1;LATITUDE 'LATITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",LATITUDE,-1,-1;LONGITUDE 'LONGITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",LONGITUDE,-1,-1;OUTOFUTM 'OUTOFUTM' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",OUTOFUTM,-1,-1;NOUTM 'NOUTM' true true false 8 Double 0 0 ,First,#," +  PTTW_NAD83 + ",NOUTM,-1,-1;PERMIT_UC 'PERMIT_UC' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",PERMIT_UC,-1,-1;FILENO_UC 'FILENO_UC' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",FILENO_UC,-1,-1;CLNTNM_UC 'CLNTNM_UC' true true false 200 Text 0 0 ,First,#," +  PTTW_NAD83 + ",CLNTNM_UC,-1,-1;CLNTNO_UC 'CLNTNO_UC' true true false 150 Text 0 0 ,First,#," +  PTTW_NAD83 + ",CLNTNO_UC,-1,-1;ID 'ID' true true false 500 Text 0 0 ,First,#," +  PTTW_NAD83 + ",ID,-1,-1;LEGEND 'LEGEND' true true false 50 Text 0 0 ,First,#," +  PTTW_NAD83 + ",LEGEND,-1,-1", "")


# Process: Delete Field...
gp.DeleteField_management(PTTW_DataDownload, "FILENO;CLIENTNO;ADDRESS;CITY;PROVINCE;POSTALCODE;PHONE;OUTOFUTM;NOUTM;ORIGEAST;ORIGNORTH;MUN_CA_AUT;REFERENCE;PERMIT_UC;FILENO_UC;CLNTNM_UC;CLNTNO_UC;ID;LEGEND")

# Process: Feature Class to Feature Class (2)...
gp.FeatureClassToFeatureClass_conversion(PTTW_DataDownload, GDB_PATH, "PTTW_DataDownload_Active", "ACTIVE = 'Yes'", "PERMITNO 'PERMITNO' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",PERMITNO,-1,-1;CLIENTNAME 'CLIENTNAME' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",CLIENTNAME,-1,-1;PURPOSECAT 'PURPOSECAT' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",PURPOSECAT,-1,-1;SPURPOSE 'SPURPOSE' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",SPURPOSE,-1,-1;EXPIRYDATE 'EXPIRYDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_DataDownload + ",EXPIRYDATE,-1,-1;ISSUEDDATE 'ISSUEDDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_DataDownload + ",ISSUEDDATE,-1,-1;RENEWDATE 'RENEWDATE' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",RENEWDATE,-1,-1;OLDCTYTWN 'OLDCTYTWN' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",OLDCTYTWN,-1,-1;P_LOT 'P_LOT' true true false 150 Text 0 0 ,First,#," +  PTTW_DataDownload + ",P_LOT,-1,-1;P_CON 'P_CON' true true false 150 Text 0 0 ,First,#," +  PTTW_DataDownload + ",P_CON,-1,-1;P_MUNICIP 'P_MUNICIP' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",P_MUNICIP,-1,-1;P_UPPERT 'P_UPPERT' true true false 150 Text 0 0 ,First,#," +  PTTW_DataDownload + ",P_UPPERT,-1,-1;P_LOWERT 'P_LOWERT' true true false 200 Text 0 0 ,First,#," +  PTTW_DataDownload + ",P_LOWERT,-1,-1;SURFGRND 'SURFGRND' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",SURFGRND,-1,-1;EASTING 'EASTING' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",EASTING,-1,-1;NORTHING 'NORTHING' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",NORTHING,-1,-1;UTMZONE 'UTMZONE' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",UTMZONE,-1,-1;MAXL_DAY 'MAXL_DAY' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",MAXL_DAY,-1,-1;DAYS_YEAR 'DAYS_YEAR' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",DAYS_YEAR,-1,-1;HRS_DAYMAX 'HRS_DAYMAX' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",HRS_DAYMAX,-1,-1;L_MINUTE 'L_MINUTE' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",L_MINUTE,-1,-1;AMENDED_BY 'AMENDED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",AMENDED_BY,-1,-1;EXPIRED_BY 'EXPIRED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",EXPIRED_BY,-1,-1;PERMIT_END 'PERMIT_END' true true false 8 Date 0 0 ,First,#," +  PTTW_DataDownload + ",PERMIT_END,-1,-1;ORIGEAST 'ORIGEAST' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",ORIGEAST,-1,-1;ORIGNORTH 'ORIGNORTH' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",ORIGNORTH,-1,-1;ACTIVE 'ACTIVE' true true false 3 Text 0 0 ,First,#," +  PTTW_DataDownload + ",ACTIVE,-1,-1;MUN_CA_AUT 'MUN_CA_AUT' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",MUN_CA_AUT,-1,-1;REFERENCE 'REFERENCE' true true false 50 Text 0 0 ,First,#," +  PTTW_DataDownload + ",REFERENCE,-1,-1;LATITUDE 'LATITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",LATITUDE,-1,-1;LONGITUDE 'LONGITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_DataDownload + ",LONGITUDE,-1,-1", "")


# Process: Project...

gp.Project_management(PTTW_DataDownload_Active, PTTW_Active_WebMercater, "PROJCS['WGS_1984_Web_Mercator_Auxiliary_Sphere',GEOGCS['GCS_WGS_1984',DATUM['D_WGS_1984',SPHEROID['WGS_1984',6378137.0,298.257223563]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]],PROJECTION['Mercator_Auxiliary_Sphere'],PARAMETER['False_Easting',0.0],PARAMETER['False_Northing',0.0],PARAMETER['Central_Meridian',0.0],PARAMETER['Standard_Parallel_1',0.0],PARAMETER['Auxiliary_Sphere_Type',0.0],UNIT['Meter',1.0]]", "NAD_1983_To_WGS_1984_5", "GEOGCS['GCS_North_American_1983',DATUM['D_North_American_1983',SPHEROID['GRS_1980',6378137.0,298.257222101]],PRIMEM['Greenwich',0.0],UNIT['Degree',0.0174532925199433]]")
gp.Delete_management(PTTW_DataDownload_Active, "FeatureClass")

# Process: Spatial Join...
gp.SpatialJoin_analysis(PTTW_Active_WebMercater, WSHED_TERT_20110530_Simplify, PermitsToTakeWater_Active_Watershed, "JOIN_ONE_TO_ONE", "KEEP_ALL", "PERMITNO 'PERMITNO' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",PERMITNO,-1,-1;CLIENTNAME 'CLIENTNAME' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",CLIENTNAME,-1,-1;PURPOSECAT 'PURPOSECAT' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",PURPOSECAT,-1,-1;SPURPOSE 'SPURPOSE' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",SPURPOSE,-1,-1;EXPIRYDATE 'EXPIRYDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_Active_WebMercater + ",EXPIRYDATE,-1,-1;ISSUEDDATE 'ISSUEDDATE' true true false 8 Date 0 0 ,First,#," +  PTTW_Active_WebMercater + ",ISSUEDDATE,-1,-1;RENEWDATE 'RENEWDATE' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",RENEWDATE,-1,-1;OLDCTYTWN 'OLDCTYTWN' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",OLDCTYTWN,-1,-1;P_LOT 'P_LOT' true true false 150 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",P_LOT,-1,-1;P_CON 'P_CON' true true false 150 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",P_CON,-1,-1;P_MUNICIP 'P_MUNICIP' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",P_MUNICIP,-1,-1;P_UPPERT 'P_UPPERT' true true false 150 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",P_UPPERT,-1,-1;P_LOWERT 'P_LOWERT' true true false 200 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",P_LOWERT,-1,-1;SURFGRND 'SURFGRND' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",SURFGRND,-1,-1;EASTING 'EASTING' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",EASTING,-1,-1;NORTHING 'NORTHING' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",NORTHING,-1,-1;UTMZONE 'UTMZONE' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",UTMZONE,-1,-1;MAXL_DAY 'MAXL_DAY' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",MAXL_DAY,-1,-1;DAYS_YEAR 'DAYS_YEAR' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",DAYS_YEAR,-1,-1;HRS_DAYMAX 'HRS_DAYMAX' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",HRS_DAYMAX,-1,-1;L_MINUTE 'L_MINUTE' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",L_MINUTE,-1,-1;AMENDED_BY 'AMENDED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",AMENDED_BY,-1,-1;EXPIRED_BY 'EXPIRED_BY' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",EXPIRED_BY,-1,-1;PERMIT_END 'PERMIT_END' true true false 8 Date 0 0 ,First,#," +  PTTW_Active_WebMercater + ",PERMIT_END,-1,-1;ORIGEAST 'ORIGEAST' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",ORIGEAST,-1,-1;ORIGNORTH 'ORIGNORTH' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",ORIGNORTH,-1,-1;ACTIVE 'ACTIVE' true true false 3 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",ACTIVE,-1,-1;MUN_CA_AUT 'MUN_CA_AUT' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",MUN_CA_AUT,-1,-1;REFERENCE 'REFERENCE' true true false 50 Text 0 0 ,First,#," +  PTTW_Active_WebMercater + ",REFERENCE,-1,-1;LATITUDE 'LATITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",LATITUDE,-1,-1;LONGITUDE 'LONGITUDE' true true false 8 Double 0 0 ,First,#," +  PTTW_Active_WebMercater + ",LONGITUDE,-1,-1;IDENT 'IDENT' true true false 8 Text 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,IDENT,-1,-1;NAME 'NAME' true true false 100 Text 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,NAME,-1,-1;AVG_USE 'AVG_USE' true true false 8 Text 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,AVG_USE,-1,-1;SLFLWATUSE 'SLFLWATUSE' true true false 8 Text 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,SLFLWATUSE,-1,-1;CenLng 'CenLng' true true false 8 Double 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,CenLng,-1,-1;CenLat 'CenLat' true true false 8 Double 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,CenLat,-1,-1;Shape_Length 'Shape_Length' false true true 8 Double 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,Shape_Length,-1,-1;Shape_Area 'Shape_Area' false true true 8 Double 0 0 ,First,#,Y:\\Public\\PTTW_Search.gdb\\WSHED_TERT_20110530_Simplify,Shape_Area,-1,-1", "IS_WITHIN", "0 Meters", "")
gp.Delete_management(PTTW_Active_WebMercater, "FeatureClass")
# Process: Delete Field...
gp.DeleteField_management(PermitsToTakeWater_Active_Watershed, "Join_Count;CenLng;CenLat")
gp.FeatureClassToShapefile_conversion(PTTW_DataDownload, PATH)
